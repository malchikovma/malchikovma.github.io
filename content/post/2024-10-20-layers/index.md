---
title: 'Разделяем программу на слои'
date: 2024-10-20T12:32:07+03:00
draft: true
image: 'slice-of-cake.webp'
links:
    - title: Фото в заголовке
      description: By Annie Spratt on Unsplash
      website: https://unsplash.com/@anniespratt?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash
---

## Введение

В продолжение предыдущей статьи [^1], поговорим о слоях приложения.

[^1]: [Превращаем процедурный код в объектно-ориентированный](/post/2024-10-18-oop-php/)

Практически любое приложение получает данные на вход, обрабатывает их, и отдает на выход. Гораздо проще рассуждать о программе, как о черном ящике, который производит какое-то действие. Не так важно, что мы подаем на вход, и куда пишем вывод: пользовательский ввод (команда в консоли, HTTP-запрос, cron-job), база данных, файл и пр. Современные приложения полагаются на этот принцип и стремятся отделить свою логику от ввода и вывода. Такой подход называется архитектурой портов и адаптеров. Как аналогию, можно представить аудио-микшер: на вход подключаем микрофон и гитару, вывод на аудиокарту и динамик.

![Photo by Feelfarbig Magazine on Unsplash](audio-mixer.webp)

Такой подход прекрасно работает в объектно-ориентированных языках. Давайте возьмем программу из предыдущей статьи и посмотрим, как бы она выглядела в реальном приложении.

## HTTP-интерфейс

> Пример упрощен для лучшего восприятия. Понятно, что ради деления двух чисел нет смысла все так усложнять.

Допустим, данные о стране мы хотим получать по REST API. Напишем контроллер в выдуманном фреймворке (они все работают по похожей схеме):

```php
// GET /country/uk/density
class CountryController
{
    public function actionDensity($countryName)
    {
        $density = $this->countryService->getCountryDensity($countryName);
        $this->json($density);
    }
}
```

Здесь входным входым параметром приложения будет HTTP-запрос и API [restcountries.com](https://restcountries.com/). Выходным - HTTP-ответ.

